!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);let s=(t,e=document)=>e.querySelector(t),o=(t,e={})=>{let i=document.createElement(t);for(let t in e)i.setAttribute(t,e[t]);return i},l=(t,e,i,s)=>{t.addEventListener(e,i,!!s)};function n(t,e,i,s,o){l(t,i,i=>{const o=i.target,l=t.querySelectorAll(e);let n=l.length;for(;n--;)if(l[n]===o){s.call(o,i);break}},!!o)}let d=t=>{for(let e in t)if(t.hasOwnProperty(e))return!0;return!1},r=t=>t.dataset.id?t.dataset.id:t!==document?r(t.parentNode):void 0;let a=new class{constructor(t){this.template=t,this.newItem=s(".new-item"),this.itemList=s(".item-list"),this.count=s(".count"),this.completeBtn=s(".complete-btn"),this.activeBtn=s(".active-btn"),this.clearAllBtn=s(".clear-complete"),this.showAllBtn=s(".all-advance"),this.togglyAll=s(".toggly-all")}setItems(t){this.itemList.innerHTML=this.template.setItems(t)}disabledBtn(t){if(!d(t))return this.completeBtn.setAttribute("disabled",""),void this.clearAllBtn.setAttribute("disabled","");this.completeBtn.removeAttribute("disabled"),this.clearAllBtn.removeAttribute("disabled")}setCount(t){this.count.innerText=t>0?this.template.activeCount(t):""}editItemBegin(t,e){t.appendChild(this.template.setEdit(e));let i=s("textarea",t);setTimeout(i.focus(),0)}editItemSave(t){t.parentElement.removeChild(t)}cleanNewItem(){this.newItem.value=""}bindAddItem(t){l(this.newItem,"change",e=>{t(e.target),this.cleanNewItem()})}bindDeleteItem(t){n(this.itemList,".destroy","click",t)}bindCompletedToggly(t){n(this.itemList,".checkbox","click",t)}bindEditItemBegin(t){n(this.itemList,".content","dblclick",e=>{t(e)})}bindFilter(t,e){l(t,"click",e)}bindClearCompleted(t){l(this.clearAllBtn,"click",t)}bindToggleAll(t){l(this.togglyAll,"click",t)}bindEditItemSave(t){n(this.itemList,".edit>textarea","blur",t,!0),n(this.itemList,".edit>textarea","keypress",({target:t,keyCode:e})=>{13===e&&t.blur()},!0),n(this.itemList,".edit>textarea","keydown",({target:t,keyCode:e})=>{27===e&&(t.dataset.esc="true",t.blur())},!0)}}(new class{setItems(t){let e="";for(let i in t)e+=`<div data-id="${i}" class="todo-item">\n\t\t\t\t      <div class="${t[i].complete?"complete":"active"}">\n\t\t\t\t          <input type="checkbox" class="checkbox">\n\t\t\t\t          <label class="content">${t[i].content}</label>\n\t\t\t\t          <button class="destroy"></button>\n\t\t\t\t\t  </div>\n\t\t\t\t  </div>`;return e}setItem(t,e){let i=o("div",{class:"todo-item","data-id":e}),s=`<div class="${t.complete?"complete":"active"}">\n\t\t\t\t\t\t<input type="checkbox" class="checkbox">\n\t\t\t\t\t\t<label class="content">${t.content}</label>\n\t\t\t\t\t\t<button class="destroy"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;return i.innerHTML=s,i}setEdit(t){let e=o("div",{class:"popap"}),i=`<div class="edit">\n\t\t\t\t     <textarea cols="100" rows="10">${t}</textarea>\n\t\t\t\t </div>`;return e.innerHTML=i,e}activeCount(t){let e=t%10;return 1==e?t+" задание":e>1&&e<=4?t+" задания":e>4?t+" заданий":t>10&&t<15?t+" заданий":void 0}}),c=new class{constructor(t,e){this.model=t,this.view=e,e.bindAddItem(this.addItem.bind(this)),e.bindDeleteItem(this.deleteItem.bind(this)),e.bindCompletedToggly(this.completedToggle.bind(this)),e.bindEditItemBegin(this.editItemBegin.bind(this)),e.bindEditItemSave(this.editItemSave.bind(this)),e.bindFilter(e.completeBtn,this.viewComplete.bind(this)),e.bindFilter(e.activeBtn,this.viewActive.bind(this)),e.bindFilter(e.showAllBtn,this.setItems.bind(this)),e.bindClearCompleted(this.deleteCompleted.bind(this)),e.bindToggleAll(this.toggleAll.bind(this))}setItems(){this.view.setItems(this.model.getTodo()),this.view.disabledBtn(this.model.filter(!0)),this.setCount()}viewComplete(){this.view.setItems(this.model.filter(!0))}viewActive(){this.view.setItems(this.model.filter(!1))}deleteCompleted(){this.model.deletCompleted(),this.setItems()}addItem(t){let e=Date.now(),i={content:t.value.trim(),complete:!1};this.model.setTodo(i,e),this.setItems()}deleteItem(t){let e=r(t.target);this.model.deletTodo(e),this.setItems()}completedToggle(t){let e=r(t.target);this.model.setComplete(e),this.setItems()}editItemBegin(t){let e=t.target.parentElement.parentElement,i=t.target.innerText;this.view.editItemBegin(e,i)}editItemSave(t){if(t.target.dataset.esc)return void this.setItems();let e=t.target.parentElement.parentElement,i=r(t.target),s=t.target.value.trim();this.model.editTodo(i,s),this.view.editItemSave(e),this.setItems()}toggleAll(){this.model.toggleAll(),this.setItems()}setCount(){this.view.setCount(this.model.activeCount())}}(new class{constructor(t){this.storage=t,this.todo=this.getTodo()}getTodo(){return this.todo||this.storage.getLocalStorage()}setTodo(t,e){let i=this.getTodo();i[e]=t,this.storage.setLocalStorage(this.todo=i)}editTodo(t,e){let i=this.getTodo();e!=i[t].content&&""!=e&&(i[t].content=e,this.storage.setLocalStorage(this.todo=i))}setComplete(t){let e=this.getTodo();e[t].complete=!e[t].complete,this.storage.setLocalStorage(this.todo=e)}deletTodo(t){let e=this.getTodo();delete e[t],this.storage.setLocalStorage(this.todo=e)}deletCompleted(){let t=this.getTodo();for(let e in t)t[e].complete&&this.deletTodo(e)}toggleAll(){let t=this.getTodo(),e=!1,i=[];for(let s in t)t[s].complete||(e=!0,i.push(s));if(e)i.forEach(t=>{this.setComplete(t)});else for(let e in t)this.setComplete.call(this,e)}activeCount(){if(!this.todo)return 0;let t=0;for(let e in this.todo)this.todo[e].complete||t++;return t}filter(t){let e=this.getTodo(),i={},s={};for(let t in e)e[t].complete?i[t]=e[t]:s[t]=e[t];return t?i:s}}(new class{constructor(t){const e=window.localStorage;this.getLocalStorage=(()=>JSON.parse(e.getItem(t)||"{}")),this.setLocalStorage=(i=>{e.setItem(t,JSON.stringify(i))})}}("mara")),a);window.onload=(()=>{c.setItems()})}]);